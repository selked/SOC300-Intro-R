)) |>
add_p() |>
modify_header(statistic ~ "Chi-squre value")
)
## Three-way crosstab
gss_sub |>
drop_na(realrinc_recoded, hlthinsr, black_white) |>
tbl_strata(
strata = black_white,
.tbl_fun =
~ .x |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p() |>
modify_header(statistic ~ "Chi-squre value")
)
library(gt)
## Three-way crosstab
gss_sub |>
drop_na(realrinc_recoded, hlthinsr, black_white) |>
tbl_strata(
strata = black_white,
.tbl_fun =
~ .x |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p() |>
modify_header(statistic ~ "Chi-squre value")
)
gss_sub |>
drop_na(realrinc_recoded, hlthinsr, black_white) |>
tbl_strata(
strata = black_white,
.tbl_fun =
~ .x |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p()
gss_sub |>
drop_na(realrinc_recoded, hlthinsr, black_white) |>
tbl_strata(
strata = black_white,
.tbl_fun =
~ .x |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p()
gss_sub |>
gss_sub |>
drop_na(realrinc_recoded, hlthinsr, black_white) |>
tbl_strata(
strata = black_white,
.tbl_fun =
~ .x |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p()
## Three-way crosstab
gss_sub |>
## Three-way crosstab
gss_sub |>
drop_na(realrinc_recoded, hlthinsr, black_white) |>
tbl_strata(
strata = black_white,
.tbl_fun =
~ .x |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p() #|>
#(statistic ~ "Chi-squre value")
)
## Three-way crosstab
gss_sub |>
drop_na(realrinc_recoded, hlthinsr, black_white) |>
tbl_strata(
strata = black_white,
.tbl_fun =
~ .x |>
tbl_cross(
row = hlthinsr,
col = sex,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p() #|>
#(statistic ~ "Chi-squre value")
)
## Three-way crosstab
gss_sub |>
drop_na(realrinc_recoded, hlthinsr, black_white) |>
tbl_strata(
strata = black_white,
.tbl_fun =
~ .x |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p() |>
modify_header(statistic ~ "Chi-squre value")
)
library(tidyverse)
library(janitor)
library(gt)
library(gtsummary)
#################################
#GSS Subsetting (not for class)
#################################
#Subset the data so that we can focus on a just a few variables of interest
library(gssr)
library(gssrdoc)
gss_sub <- gss_get_yr("1998")
cont_vars <- c("year", "id", "age", "realrinc")
cat_vars <- c("race", "sex", "educ", "degree", "partyid", "happy", "marital", "attend", "cappun", "polhitok", "abany", "spanking", "affrmact", "pornlaw", "coneduc", "courts", "racdif1", "natcrimy", "fefam", "xmarsex", "hlthinsr" )
my_vars <- c(cont_vars, cat_vars)
gss_sub <- gss_sub |>
select(all_of(my_vars))
#Make sure all missing data is coded as NA
gss_sub <- gss_sub |>
mutate(across(everything(), haven::zap_missing))
#Recode categorical variables into factors
gss_sub <- gss_sub |>
mutate(across(all_of(cat_vars), forcats::as_factor))
gss_sub <- gss_sub |> haven::zap_label()
gss_sub$id <- gss_sub$id |> as.factor()
### Ordinal income Elaboration examples
gss_sub <- gss_sub |>
mutate(
realrinc_recoded = cut(
realrinc,
breaks = c(0, 35000, 80000, Inf),
include.lowest = TRUE,
right = FALSE,
labels = c("working class", "middle class", "upper class"),
ordered_result = TRUE
)
)
## Two-way crosstab with polhitok and attend_recode
gss_sub |>
drop_na(hlthinsr, realrinc_recoded) |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p() #|>
## Two-way crosstab with polhitok and attend_recode
gss_sub |>
drop_na(hlthinsr, realrinc_recoded) |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p() |>
modify_header(statistic ~ "Chi-square value")
## Three-way crosstab
gss_sub |>
drop_na(realrinc_recoded, hlthinsr, black_white) |>
tbl_strata(
strata = black_white,
.tbl_fun =
~ .x |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
) |>
add_p() |>
modify_header(statistic ~ "Chi-squre value"))
)
## Two-way crosstab with polhitok and attend_recode
gss_sub |>
drop_na(hlthinsr, realrinc_recoded) |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
) |>
add_p() |>
modify_header(statistic ~ "Chi-square value"))
## Two-way crosstab with polhitok and attend_recode
gss_sub |>
drop_na(hlthinsr, realrinc_recoded) |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
) |>
add_p() |>
modify_header(statistic ~ "Chi-square value"))
## Two-way crosstab with polhitok and attend_recode
gss_sub |>
drop_na(hlthinsr, realrinc_recoded) |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p() |>
modify_header(statistic ~ "Chi-square value")
## Two-way crosstab with polhitok and attend_recode
gss_sub |>
drop_na(hlthinsr, realrinc_recoded) |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p() |>
modify_header(statistic ~ "Chi-square value")
## Two-way crosstab with polhitok and attend_recode
gss_sub |>
drop_na(hlthinsr, realrinc_recoded) |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p() |>
modify_header(statistic ~ "Chi-square value")
rlang::last_trace()
our_gss |>
drop_na(cappun, dem_rep) |>
tbl_cross(
row = cappun,
col = dem_rep,
percent = "row",
margin = c("column", "row"),
label = list(
cappun = "Death Penalty Attitude",
dem_rep = "Political Party"
)) |>
add_p() |>
modify_header(statistic ~ "Chi-square value")
gss_sub |>
drop_na(cappun, dem_rep) |>
tbl_cross(
row = cappun,
col = dem_rep,
percent = "row",
margin = c("column", "row"),
label = list(
cappun = "Death Penalty Attitude",
dem_rep = "Political Party"
)) |>
add_p() |>
modify_header(statistic ~ "Chi-square value")
gss_sub <- gss_sub |>
mutate(
partyid_recoded=fct_collapse(partyid,
"Democrat" = c("strong democrat", "not very strong democrat"),
"Republican" = c("strong republican","not very strong republican"),
"Independent" = c("independent, close to democrat", "independent (neither, no response)", "independent, close to republican"),
"Other Party" = c("other party")
)) |>
mutate(dem_rep = fct_recode(
partyid_recoded,
NULL="Other Party",
NULL="Independent"))
gss_sub |>
drop_na(cappun, dem_rep) |>
tbl_cross(
row = cappun,
col = dem_rep,
percent = "row",
margin = c("column", "row"),
label = list(
cappun = "Death Penalty Attitude",
dem_rep = "Political Party"
)) |>
add_p() |>
modify_header(statistic ~ "Chi-square value")
## Two-way crosstab with polhitok and attend_recode
gss_sub |>
drop_na(hlthinsr, realrinc_recoded) |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p() |>
modify_header(statistic ~ "Chi-square value")
## Two-way crosstab with polhitok and attend_recode
gss_sub |>
drop_na(hlthinsr, realrinc_recoded) |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "row",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p() |>
modify_header(statistic ~ "Chi-square value")
## Two-way crosstab with polhitok and attend_recode
gss_sub |>
drop_na(hlthinsr, realrinc_recoded) |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p() |>
modify_header(statistic ~ "Chi-square value")
## Two-way crosstab with polhitok and attend_recode
gss_sub |>
drop_na(hlthinsr, realrinc_recoded) |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
modify_header(statistic ~ "Chi-square value") |>
add_p()
## Two-way crosstab with polhitok and attend_recode
gss_sub |>
drop_na(hlthinsr, realrinc_recoded) |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p() |>
modify_header(statistic ~ "Chi-square value")
## Three-way crosstab
gss_sub |>
drop_na(realrinc_recoded, hlthinsr, black_white) |>
tbl_strata(
strata = black_white,
.tbl_fun =
~ .x |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
) |>
add_p() |>
modify_header(statistic ~ "Chi-squre value"))
)
## Two-way crosstab with polhitok and attend_recode
gss_sub |>
drop_na(hlthinsr, realrinc_recoded) |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p() #|>
## Two-way crosstab with polhitok and attend_recode
stupid_fucking_piece_of_shit_table <- gss_sub |>
drop_na(hlthinsr, realrinc_recoded) |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p() #|>
View(stupid_fucking_piece_of_shit_table)
## Two-way crosstab with polhitok and attend_recode
stupid_fucking_piece_of_shit_table <- gss_sub |>
drop_na(hlthinsr, realrinc_recoded) |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p(test = everything() ~ "chisq.test.no.correct") |>
modify_header(statistic ~ "Chi-square value")
## Two-way crosstab with polhitok and attend_recode
stupid_fucking_piece_of_shit_table <- gss_sub |>
drop_na(hlthinsr, realrinc_recoded) |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p(test = everything() ~ "chisq.test.no.correct") #|>
## Two-way crosstab with polhitok and attend_recode
stupid_fucking_piece_of_shit_table <- gss_sub |>
drop_na(hlthinsr, realrinc_recoded) |>
tbl_cross(
row = hlthinsr,
col = realrinc_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
hlthinsr = "Health insurance coverage",
realrinc_recoded = "Social class"
)) |>
add_p(test = all_categorical() ~ "chisq.test.no.correct") #|>
stupid_fucking_piece_of_shit_table
