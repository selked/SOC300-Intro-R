aes(x = femaleu, y = comp_sim)) +
geom_point(size = .5) +
geom_smooth(method = "lm", color = "brown", linewidth = .65) +
labs(
title = "Predicted Warmth/Competence Language, no controls",
x = "Percentage of women",
y = "Warmth/Competence Score"
) +
scale_x_continuous(
labels = percent_format()
) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
my_patch <- (p2 | p1)
my_patch
p2 <- workingjobs.df |>
ggplot(
aes(x = femaleu, y = comp_sim)) +
geom_point(size = .5) +
geom_smooth(method = "lm", color = "brown", linewidth = .75) +
labs(
title = "Predicted Warmth/Competence Language, no controls",
x = "Percentage of women",
y = "Warmth/Competence Score"
) +
scale_x_continuous(
labels = percent_format()
) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
my_patch <- (p2 | p1)
my_patch
p2 <- workingjobs.df |>
ggplot(
aes(x = femaleu, y = comp_sim)) +
geom_point(size = .5) +
geom_smooth(method = "lm", color = "brown", linewidth = .75) +
labs(
title = "No controls",
x = "% Women",
y = "Predicted Warmth/Competence Score"
) +
scale_x_continuous(
labels = percent_format()
) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
p1 <- plot_model(our_multimodel, type = "pred", terms = "femaleu", show.data = TRUE, colors = "yellow", dot.size = .75) +
labs(
title = "Controlling for Salary",
x = "% Women",
y = "Predicted Warmth/Competence Scale") +
scale_x_continuous(labels = percent_format()) +
theme_ft_rc(
base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
my_patch
my_patch <- (p2 | p1)
my_patch
#################################
#GSS Subsetting (not for class)
#################################
#Subset the data so that we can focus on a just a few variables of interest
library(gssr)
library(gssrdoc)
library(tidyverse)
library(janitor)
library(gtsummary)
gss_sub <- gss_get_yr("2012")
cont_vars <- c("year", "id", "age", "realrinc")
#################################
#GSS Subsetting (not for class)
#################################
#Subset the data so that we can focus on a just a few variables of interest
library(gssr)
library(gssrdoc)
library(tidyverse)
gss_sub <- gss_get_yr("2012")
cont_vars <- c("year", "id", "age", "realrinc")
cat_vars <- c("race", "sex", "educ", "degree", "partyid", "happy", "marital", "attend", "cappun", "polhitok", "abany", "spanking", "affrmact", "pornlaw", "coneduc", "courts", "racdif1", "natcrimy", "fefam", "xmarsex", "hlthinsr", "convictd", "family16")
my_vars <- c(cont_vars, cat_vars)
gss_sub <- gss_sub |>
select(all_of(my_vars))
cat_vars <- c("race", "sex", "educ", "degree", "partyid", "happy", "marital", "attend", "cappun", "polhitok", "abany", "spanking", "affrmact", "pornlaw", "coneduc", "courts", "racdif1", "natcrimy", "fefam", "xmarsex", "convictd", "family16")
my_vars <- c(cont_vars, cat_vars)
gss_sub <- gss_sub |>
select(all_of(my_vars))
#Make sure all missing data is coded as NA
gss_sub <- gss_sub |>
mutate(across(everything(), haven::zap_missing))
#Recode categorical variables into factors
gss_sub <- gss_sub |>
mutate(across(all_of(cat_vars), forcats::as_factor))
gss_sub <- gss_sub |> haven::zap_label()
gss_sub$id <- gss_sub$id |> as.factor()
View(gss_sub)
library(gtsummary)
count(gss_sub, family16)
gss_sub <- gss_sub |>
mutate(family16_recoded = fct_collapse(
"Yes" = c("both own parents"),
"No" = c("other", "father and stepparent", "mother and stepparent", "father only", "mother only", "some other male relative (no female head", "some other female relative (no male head)", "other arrangement with relatives (e.g., aunt and uncle, grandparents)")
))
gss_sub <- gss_sub |>
mutate(family16_recoded = fct_collapse(
family16,
"Yes" = c("both own parents"),
"No" = c("other", "father and stepparent", "mother and stepparent", "father only", "mother only", "some other male relative (no female head", "some other female relative (no male head)", "other arrangement with relatives (e.g., aunt and uncle, grandparents)")
))
gss_sub <- gss_sub |>
mutate(family16_recoded = fct_collapse(
family16,
"Yes" = c("both own parents"),
"No" = c("other", "father and stepparent", "mother and stepparent", "father only", "mother only", "some other male relative (no female head)", "some other female relative (no male head)", "other arrangement with relatives (e.g., aunt and uncle, grandparents)")
))
View(gss_sub)
count(our_gss, family16_recoded)
count(gss_sub, family16_recoded)
## Two-way crosstab with polhitok and attend_recode
gss_sub |>
drop_na(family16_recoded, convictd) |>
tbl_cross(
row = family16_recoded,
col = convictd,
percent = "column",
margin = c("column", "row"),
label = list(
family16_recoded = "Living with own parents at 16",
convictd = "Ever convicted of a crime"
)) |>
add_p() |>
modify_header(statistic ~ "Chi-square value")
gss_sub <- gss_sub |>
mutate(affrmact_recoded = fct_collapse(
affrmact,
"Favors" = c("strongly favors", "not strongly favors"),
"Opposes" = c("strongly opposes", "not strongly opposes")
))
count(gss_sub, xmarsex)
gss_sub <- gss_sub |>
mutate(xmarsex_recoded = fct_collapse(
xmarsex,
"Always Wrong" = c("always wrong"),
"Sometimes Wrong" = c("almost always wrong", "wrong only sometimes"),
"Never Wrong" = c("not wrong at all")
))
count(gss_sub, fefam)
gss_sub <- gss_sub |>
mutate(fefam_recoded = fct_collapse(
fefam,
"Agree" = c("strongly agree", "agree"),
"Disagree" = c("disagree", "strongly disagree")
))
count(gss_sub, courts)
gss_sub$courts <-factor(
gss_sub$courts,
levels = c("too harshly", "about right", "not harshly enough"),
ordered = TRUE)
gss_sub <- gss_sub |>
mutate(
age_recoded = cut(
age,
breaks = c(18, 36, 50, Inf),
include.lowest = TRUE,
right = FALSE,
labels = c("Younger", "Middle Age", "Older"),
ordered_result = TRUE
)
)
gss_sub <- gss_sub |>
mutate(attend_recoded = fct_collapse(
attend,
"Often" = c("about once a month", "2-3 times a month", "nearly every week", "every week", "several times a week"),
"Sometimes" = c("less than once a year", "about once or twice a year", "several times a year"),
"Never" = "never"
))
save(gss_sub, file = "C:/Users/selke/Desktop/our_gss.rda")
our_gss <- gss_sub
save(our_gss, file = "C:/Users/selke/Desktop/our_gss_2012.rda")
View(our_gss)
str(our_gss)
summary(our_gss$realrinc)
## Two-way crosstab with polhitok and attend_recode
gss_sub |>
drop_na(family16_recoded, convictd) |>
tbl_cross(
row = convictd,
col = family16_recoded,
percent = "column",
margin = c("column", "row"),
label = list(
family16_recoded = "Living with own parents at 16",
convictd = "Ever convicted of a crime"
)) |>
add_p() |>
modify_header(statistic ~ "Chi-square value")
library(sysfonts)
sysfonts::font_add_google("Roboto Condensed")
sysfonts::font_add("Arial Narrow", regular = "ARIALN.ttf")
library(showtext)
library(hrbrthemes)
library(tidyverse)
library(scales)
library(wesanderson)
library(modelbased)
library(sjPlot)
library(patchwork)
showtext.auto()
x <- 0:5
y <- 0:5
df <- data.frame(
x,
y
)
knitr::kable(df)
df |>
ggplot(
aes(x, y)) +
geom_point(color = "yellow") +
geom_line(color = "green") +
labs(
title = "Simple line demonstration"
) +
coord_cartesian(
xlim = c(-5,5),
ylim = c(-5,5)) +
geom_hline(yintercept = 0, color = "gray") +
geom_vline(xintercept = 0, color = "gray") +
scale_x_continuous(breaks = seq(-5,5,1)) +
scale_y_continuous(breaks = seq(-5,5,1)) +
annotate(
"segment",
x = 2,
xend = 3,
y = 2,
colour = "orange") +
annotate(
"segment",
x = 3,
y = 2,
yend = 3,
color = "orange") +
annotate(
"text",
x = 2.5,
y = 1.5,
label = "run"
) +
annotate(
"text",
x = 3.5,
y = 2.5,
label = "rise"
) +
theme_ft_rc(
base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
load("C:/Users/selke/Desktop/Scholarship/USAJobs Project/ja_reprocessed.rda")
library(gtsummary)
names(workingjobs.df)[61] <- "Percentage of women"
names(workingjobs.df)[141] <- "Warmth/Competence Scale"
stats <- c("N" = "{length}",
"Mean (SD)" = "{mean} ({sd})",
"Min" = "{min}",
"Max" = "{max}")
tbl <-
purrr::imap(
stats,
~workingjobs.df |>
tbl_summary(include = c("Warmth/Competence Scale", "Percentage of women"),
missing = "no",
statistic = ~.x,
digits = ~ list(
length = label_style_number(digits = 0)
))  |>
modify_header(all_stat_cols() ~ stringr::str_glue("**{.y}**"))) |>
tbl_merge(tab_spanner = FALSE) |>
modify_footnote(~NA) |>
modify_header(label ~"**Variable**")
tbl
workingjobs.df |>
ggplot(
aes(x = `Percentage of women`, y = `Warmth/Competence Scale`)) +
geom_point(size = .5) +
labs(
title = "Warmth/Competence Language by Percentage of Women",
x = "Percentage of women",
y = "Warmth/Competence Score"
) +
scale_x_continuous(
labels = percent_format()
) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
library(scales)
workingjobs.df |>
ggplot(
aes(x = `Percentage of women`, y = `Warmth/Competence Scale`)) +
geom_point(size = .5) +
geom_smooth(method = "lm", color = "yellow", linewidth = .75) +
labs(
title = "Warmth/Competence Language by Percentage of Women",
x = "Percentage of women",
y = "Warmth/Competence Score"
) +
scale_x_continuous(
labels = percent_format()
) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
names(workingjobs.df)[61] <- "femaleu"
workingjobs.df <- workingjobs.df |>
mutate(
female_perc = femaleu * 100
)
our_model <- lm(`Warmth/Competence Scale` ~ female_perc, data = workingjobs.df)
library(flextable)
library(huxtable)
c_tab<-huxreg(
our_model,
statistics = c("Number of observations" = "nobs", "R-squared" = "r.squared"),
coefs = c("(Intercept)" = "(Intercept)", "Percentage of women" = "female_perc")) |>
set_caption("OLS Regression Output")
c_tab <- as_flextable(c_tab)
c_tab <- theme_vader(c_tab)
c_tab
c_tab
c_tab
workingjobs.df |>
ggplot(
aes(x = femaleu, y = `Warmth/Competence Scale`)) +
geom_point(size = .5) +
geom_smooth(method = "lm", color = "yellow", linewidth = .75) +
labs(
title = "Warmth/Competence Language by Percentage of Women",
x = "Percentage of women",
y = "Warmth/Competence Score"
) +
scale_x_continuous(
labels = percent_format()
) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
names(workingjobs.df)[61] <- "femaleu"
names(workingjobs.df)[141] <- "comp_sim"
workingjobs.df <- workingjobs.df |>
mutate(sal_ord = cut(
sal_mean,
breaks = c(20000, 70000, 100000, Inf),
right = FALSE,
include.lowest = TRUE,
ordered_result = FALSE,
labels = c("Lower-middle class", "Middle class", "Upper class")
))
our_multimodel <- lm(comp_sim ~ sal_ord, data = workingjobs.df)
c_tab<-huxreg(
our_multimodel,
statistics = c("Number of observations" = "nobs", "R-squared" = "r.squared"),
coefs = c("(Intercept)" = "(Intercept)", "Salary: Middle Class" = "sal_ordMiddle class", "Salary: Upper Class" = "sal_ordUpper class")) |>
set_caption("OLS Regression Output")
c_tab <- as_flextable(c_tab)
c_tab <- theme_vader(c_tab)
c_tab
# Calculate the mean for the reference level
workingjobs.df |>
filter(sal_ord == "Lower-middle class") |>
summarize(
mean_lower_middle = mean(comp_sim)
) |>
knitr::kable()
# Calculate the mean of Middle class
workingjobs.df |>
filter(sal_ord == "Middle class") |>
summarize(
mean_middle = mean(comp_sim)
) |>
knitr::kable()
# Subtract the mean of 'lower-middle class' cases from the mean of 'middle class' cases
(-0.06711311) - (-0.4523064)
our_multimodel <- lm(comp_sim ~ female_perc + sal_ord, data =  workingjobs.df)
c_tab<-huxreg(
our_multimodel,
statistics = c("Number of observations" = "nobs", "R-squared" = "r.squared"),
coefs = c("(Intercept)" = "(Intercept)", "Percentage of women" = "female_perc", "Salary: Middle Class" = "sal_ordMiddle class", "Salary: Upper Class" = "sal_ordUpper class")) |>
set_caption("OLS Regression Output")
c_tab <- as_flextable(c_tab)
c_tab <- theme_vader(c_tab)
c_tab
c_tab
means <- estimate_means(our_multimodel, by = "sal_ord")
workingjobs.df |>
ggplot(aes(x = sal_ord, y = comp_sim)) +
# Add base data
geom_violin(aes(fill = sal_ord), alpha = .5) +
geom_jitter(aes(color = sal_ord), width = 0.1, height = 0, alpha = 0.25, size = .75) +
# Add pointrange and line for means
geom_line(data = means, aes(y = Mean, group = 1), linewidth = 1, color = "white") +
geom_pointrange(
data = means,
aes(y = Mean, ymin = CI_low, ymax = CI_high),
size = .25,
color = "black"
) +
labs(
title = "Model Estimated Warmth/Competence Means for Levels of Salary",
x = "Salary Level",
y = "Warmth/Competence Scale"
) +
guides(
fill = "none",
color = "none"
) +
scale_fill_manual(values = wes_palette("AsteroidCity1")) +
scale_color_manual(values = wes_palette("AsteroidCity1")) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
# Some spare code from visualization brainstorming
our_multimodel <- lm(comp_sim ~ femaleu + sal_ord, data =  workingjobs.df)
p1 <- plot_model(our_multimodel, type = "pred", terms = "femaleu", show.data = TRUE, colors = "yellow", dot.size = .75) +
labs(
title = "Controlling for Salary",
x = "% Women",
y = "Predicted Warmth/Competence Scale") +
scale_x_continuous(labels = percent_format()) +
theme_ft_rc(
base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
p2 <- workingjobs.df |>
ggplot(
aes(x = femaleu, y = comp_sim)) +
geom_point(size = .5, alpha = .5) +
geom_smooth(method = "lm", color = "red", linewidth = .75) +
labs(
title = "No controls",
x = "% Women",
y = "Warmth/Competence Scale") +
scale_x_continuous(
labels = percent_format()
) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
my_patch <- (p2 | p1)
my_patch
library(jtools)
our_model <- lm(comp_sim ~ female_perc, workingjobs.df)
our_multimodel <- lm(comp_sim ~ female_perc + sal_ord, workingjobs.df)
plot_coefs(our_model, our_multimodel,
coefs = c("% Women" = "female_perc"),
scale = FALSE,
robust = TRUE, # robust standard errors when TRUE
legend.title = "Predicted Warmth/Competence Score",
model.names = c("No Controls","Controlling for Salary"),
point.size = 1) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24) +
geom_vline(xintercept = 0, color = "yellow") +
xlim(-.02,0.005) +
labs(
title = "Predicted Slope Coefficient for % Women",
y = ""
) +
theme(
legend.position = "bottom",
legend.title = element_blank())
our_multimodel <- lm(comp_sim ~ femaleu + sal_ord, data =  workingjobs.df) |>
tbl_regression()
library(broom.helpers)
our_multimodel <- lm(comp_sim ~ femaleu + sal_ord, data =  workingjobs.df) |>
tbl_regression()
our_multimodel <- lm(comp_sim ~ femaleu + sal_ord, data =  workingjobs.df)
lm(comp_sim ~ femaleu + sal_ord, data =  workingjobs.df) |>
tbl_regression()
lm(comp_sim ~ femaleu + sal_ord, data =  workingjobs.df) |>
tbl_regression(conf.int = FALSE)
lm(comp_sim ~ femaleu + sal_ord, data =  workingjobs.df) |>
tbl_regression(conf.int = FALSE, intercept = TRUE)
