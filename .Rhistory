library(gtsummary)
names(workingjobs.df)[61] <- "Percentage of women"
names(workingjobs.df)[141] <- "Warmth/Competence Scale"
stats <- c("N" = "{length}",
"Mean (SD)" = "{mean} ({sd})",
"Min" = "{min}",
"Max" = "{max}")
tbl <-
purrr::imap(
stats,
~workingjobs.df |>
tbl_summary(include = c("Warmth/Competence Scale", "Percentage of women"),
missing = "no",
statistic = ~.x,
digits = ~ list(
length = label_style_number(digits = 0)
))  |>
modify_header(all_stat_cols() ~ stringr::str_glue("**{.y}**"))) |>
tbl_merge(tab_spanner = FALSE) |>
modify_footnote(~NA) |>
modify_header(label ~"**Variable**")
tbl
workingjobs.df |>
ggplot(
aes(x = `Percentage of women`, y = `Warmth/Competence Scale`)) +
geom_point(size = .5) +
labs(
title = "Warmth/Competence Language by Percentage of Women",
x = "Percentage of women",
y = "Warmth/Competence Score"
) +
scale_x_continuous(
labels = percent_format()
) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
library(scales)
workingjobs.df |>
ggplot(
aes(x = `Percentage of women`, y = `Warmth/Competence Scale`)) +
geom_point(size = .5) +
geom_smooth(method = "lm", color = "yellow", linewidth = .75) +
labs(
title = "Warmth/Competence Language by Percentage of Women",
x = "Percentage of women",
y = "Warmth/Competence Score"
) +
scale_x_continuous(
labels = percent_format()
) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
names(workingjobs.df)[61] <- "femaleu"
workingjobs.df <- workingjobs.df |>
mutate(
female_perc = femaleu * 100
)
our_model <- lm(`Warmth/Competence Scale` ~ female_perc, data = workingjobs.df)
library(flextable)
library(huxtable)
c_tab<-huxreg(
our_model,
statistics = c("Number of observations" = "nobs", "R-squared" = "r.squared"),
coefs = c("(Intercept)" = "(Intercept)", "Percentage of women" = "female_perc")) |>
set_caption("OLS Regression Output")
c_tab <- as_flextable(c_tab)
c_tab <- theme_vader(c_tab)
c_tab
c_tab
c_tab
workingjobs.df |>
ggplot(
aes(x = femaleu, y = `Warmth/Competence Scale`)) +
geom_point(size = .5) +
geom_smooth(method = "lm", color = "yellow", linewidth = .75) +
labs(
title = "Warmth/Competence Language by Percentage of Women",
x = "Percentage of women",
y = "Warmth/Competence Score"
) +
scale_x_continuous(
labels = percent_format()
) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
names(workingjobs.df)[61] <- "femaleu"
names(workingjobs.df)[141] <- "comp_sim"
workingjobs.df <- workingjobs.df |>
mutate(sal_ord = cut(
sal_mean,
breaks = c(20000, 70000, 100000, Inf),
right = FALSE,
include.lowest = TRUE,
ordered_result = FALSE,
labels = c("Lower-middle class", "Middle class", "Upper class")
))
our_multimodel <- lm(comp_sim ~ sal_ord, data = workingjobs.df)
c_tab<-huxreg(
our_multimodel,
statistics = c("Number of observations" = "nobs", "R-squared" = "r.squared"),
coefs = c("(Intercept)" = "(Intercept)", "Salary: Middle Class" = "sal_ordMiddle class", "Salary: Upper Class" = "sal_ordUpper class")) |>
set_caption("OLS Regression Output")
c_tab <- as_flextable(c_tab)
c_tab <- theme_vader(c_tab)
c_tab
# Calculate the mean for the reference level
workingjobs.df |>
filter(sal_ord == "Lower-middle class") |>
summarize(
mean_lower_middle = mean(comp_sim)
) |>
knitr::kable()
# Calculate the mean of Middle class
workingjobs.df |>
filter(sal_ord == "Middle class") |>
summarize(
mean_middle = mean(comp_sim)
) |>
knitr::kable()
# Subtract the mean of 'lower-middle class' cases from the mean of 'middle class' cases
(-0.06711311) - (-0.4523064)
our_multimodel <- lm(comp_sim ~ female_perc + sal_ord, data =  workingjobs.df)
c_tab<-huxreg(
our_multimodel,
statistics = c("Number of observations" = "nobs", "R-squared" = "r.squared"),
coefs = c("(Intercept)" = "(Intercept)", "Percentage of women" = "female_perc", "Salary: Middle Class" = "sal_ordMiddle class", "Salary: Upper Class" = "sal_ordUpper class")) |>
set_caption("OLS Regression Output")
c_tab <- as_flextable(c_tab)
c_tab <- theme_vader(c_tab)
c_tab
c_tab
means <- estimate_means(our_multimodel, by = "sal_ord")
workingjobs.df |>
ggplot(aes(x = sal_ord, y = comp_sim)) +
# Add base data
geom_violin(aes(fill = sal_ord)) +
geom_jitter(aes(color = sal_ord), width = 0.1, height = 0, alpha = 0.25, size = .75) +
# Add pointrange and line for means
geom_line(data = means, aes(y = Mean, group = 1), linewidth = 1) +
geom_pointrange(
data = means,
aes(y = Mean, ymin = CI_low, ymax = CI_high),
size = 1,
color = "white"
) +
labs(
title = "Model Estimated Warmth/Competence Means for Levels of Salary",
x = "Salary Level",
y = "Warmth/Competence Scale"
) +
guides(
fill = "none",
color = "none"
) +
scale_fill_manual(values = c("purple", "brown", "blue")) +
scale_color_manual(values = c("purple", "brown", "blue")) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
our_multimodel <- lm(comp_sim ~ femaleu + sal_ord, data =  workingjobs.df)
pred_data <- estimate_expectation(our_multimodel)
pred_data$comp_sim <- workingjobs.df$comp_sim
pred_data |>
ggplot(aes(x = femaleu, y = Predicted)) +
geom_point(aes(x = femaleu, y = comp_sim), size = .5, alpha = .5) +
geom_smooth(aes(x = femaleu, y = Predicted), method = lm, linewidth = .75, color = "yellow") +
labs(
title = "Model Estimated Relationships Plotted against Observed Data",
y = "Predicted Warmth/Competence Scale",
x = "Percentage of women") +
scale_x_continuous(labels = percent_format()) +
#ylim(-2,2) +
guides(color = guide_legend(title = "Salary Level")) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
View(our_multimodel)
workingjobs.df |>
ggplot(aes(x = sal_ord, y = comp_sim)) +
# Add base data
geom_violin(aes(fill = sal_ord, alpha = .5)) +
geom_jitter(aes(color = sal_ord), width = 0.1, height = 0, alpha = 0.25, size = .75) +
# Add pointrange and line for means
geom_line(data = means, aes(y = Mean, group = 1), linewidth = 1) +
geom_pointrange(
data = means,
aes(y = Mean, ymin = CI_low, ymax = CI_high),
size = 1,
color = "white"
) +
labs(
title = "Model Estimated Warmth/Competence Means for Levels of Salary",
x = "Salary Level",
y = "Warmth/Competence Scale"
) +
guides(
fill = "none",
color = "none"
) +
scale_fill_manual(values = c("purple", "brown", "blue")) +
scale_color_manual(values = c("purple", "brown", "blue")) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
workingjobs.df |>
ggplot(aes(x = sal_ord, y = comp_sim)) +
# Add base data
geom_violin(aes(fill = sal_ord, alpha = .5)) +
geom_jitter(aes(color = sal_ord), width = 0.1, height = 0, alpha = 0.5, size = .75) +
# Add pointrange and line for means
geom_line(data = means, aes(y = Mean, group = 1), linewidth = 1) +
geom_pointrange(
data = means,
aes(y = Mean, ymin = CI_low, ymax = CI_high),
size = 1,
color = "white"
) +
labs(
title = "Model Estimated Warmth/Competence Means for Levels of Salary",
x = "Salary Level",
y = "Warmth/Competence Scale"
) +
guides(
fill = "none",
color = "none"
) +
scale_fill_manual(values = c("purple", "brown", "blue")) +
scale_color_manual(values = c("purple", "brown", "blue")) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
workingjobs.df |>
ggplot(aes(x = sal_ord, y = comp_sim)) +
# Add base data
geom_violin(aes(fill = sal_ord, alpha = .5)) +
geom_jitter(aes(color = sal_ord), width = 0.1, height = 0, alpha = 0.25, size = .75) +
# Add pointrange and line for means
geom_line(data = means, aes(y = Mean, group = 1), linewidth = 1) +
geom_pointrange(
data = means,
aes(y = Mean, ymin = CI_low, ymax = CI_high),
size = 1,
color = "white"
) +
labs(
title = "Model Estimated Warmth/Competence Means for Levels of Salary",
x = "Salary Level",
y = "Warmth/Competence Scale"
) +
guides(
fill = "none",
color = "none"
) +
scale_fill_manual(values = c("purple", "brown", "blue")) +
scale_color_manual(values = c("purple", "brown", "blue")) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
workingjobs.df |>
ggplot(aes(x = sal_ord, y = comp_sim)) +
# Add base data
geom_violin(aes(fill = sal_ord), alpha = .5) +
geom_jitter(aes(color = sal_ord), width = 0.1, height = 0, alpha = 0.25, size = .75) +
# Add pointrange and line for means
geom_line(data = means, aes(y = Mean, group = 1), linewidth = 1) +
geom_pointrange(
data = means,
aes(y = Mean, ymin = CI_low, ymax = CI_high),
size = 1,
color = "white"
) +
labs(
title = "Model Estimated Warmth/Competence Means for Levels of Salary",
x = "Salary Level",
y = "Warmth/Competence Scale"
) +
guides(
fill = "none",
color = "none"
) +
scale_fill_manual(values = c("purple", "brown", "blue")) +
scale_color_manual(values = c("purple", "brown", "blue")) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
View(means)
workingjobs.df |>
ggplot(aes(x = sal_ord, y = comp_sim)) +
# Add base data
geom_violin(aes(fill = sal_ord), alpha = .5) +
geom_jitter(aes(color = sal_ord), width = 0.1, height = 0, alpha = 0.25, size = .75) +
# Add pointrange and line for means
geom_line(data = means, aes(y = Mean, group = 1), linewidth = 1) +
#geom_pointrange(
#data = means,
#aes(y = Mean, ymin = CI_low, ymax = CI_high),
#size = 1,
#color = "white"
#) +
labs(
title = "Model Estimated Warmth/Competence Means for Levels of Salary",
x = "Salary Level",
y = "Warmth/Competence Scale"
) +
guides(
fill = "none",
color = "none"
) +
scale_fill_manual(values = c("purple", "brown", "blue")) +
scale_color_manual(values = c("purple", "brown", "blue")) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
workingjobs.df |>
ggplot(aes(x = sal_ord, y = comp_sim)) +
# Add base data
geom_violin(aes(fill = sal_ord), alpha = .5) +
geom_jitter(aes(color = sal_ord), width = 0.1, height = 0, alpha = 0.25, size = .75) +
# Add pointrange and line for means
geom_line(data = means, aes(y = Mean, group = 1), linewidth = 1) +
geom_pointrange(
data = means,
aes(y = Mean, ymin = CI_low, ymax = CI_high),
size = .25,
color = "white"
) +
labs(
title = "Model Estimated Warmth/Competence Means for Levels of Salary",
x = "Salary Level",
y = "Warmth/Competence Scale"
) +
guides(
fill = "none",
color = "none"
) +
scale_fill_manual(values = c("purple", "brown", "blue")) +
scale_color_manual(values = c("purple", "brown", "blue")) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
workingjobs.df |>
ggplot(aes(x = sal_ord, y = comp_sim)) +
# Add base data
geom_violin(aes(fill = sal_ord), alpha = .5) +
geom_jitter(aes(color = sal_ord), width = 0.1, height = 0, alpha = 0.25, size = .75) +
# Add pointrange and line for means
geom_line(data = means, aes(y = Mean, group = 1), linewidth = 1) +
geom_pointrange(
data = means,
aes(y = Mean, ymin = CI_low, ymax = CI_high),
size = .25,
color = "white"
) +
labs(
title = "Model Estimated Warmth/Competence Means for Levels of Salary",
x = "Salary Level",
y = "Warmth/Competence Scale"
) +
guides(
fill = "none",
color = "none"
) +
scale_fill_manual(values = c("purple", "brown", "blue")) +
scale_color_manual(values = c("purple", "brown", "blue")) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
workingjobs.df |>
ggplot(aes(x = sal_ord, y = comp_sim)) +
# Add base data
geom_violin(aes(fill = sal_ord), alpha = .5) +
geom_jitter(aes(color = sal_ord), width = 0.1, height = 0, alpha = 0.25, size = .75) +
# Add pointrange and line for means
geom_line(data = means, aes(y = Mean, group = 1), linewidth = 1) +
geom_pointrange(
data = means,
aes(y = Mean, ymin = CI_low, ymax = CI_high),
size = .1,
color = "white"
) +
labs(
title = "Model Estimated Warmth/Competence Means for Levels of Salary",
x = "Salary Level",
y = "Warmth/Competence Scale"
) +
guides(
fill = "none",
color = "none"
) +
scale_fill_manual(values = c("purple", "brown", "blue")) +
scale_color_manual(values = c("purple", "brown", "blue")) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
workingjobs.df |>
ggplot(aes(x = sal_ord, y = comp_sim)) +
# Add base data
geom_violin(aes(fill = sal_ord), alpha = .5) +
geom_jitter(aes(color = sal_ord), width = 0.1, height = 0, alpha = 0.25, size = .75) +
# Add pointrange and line for means
geom_line(data = means, aes(y = Mean, group = 1), linewidth = 1) +
geom_pointrange(
data = means,
aes(y = Mean, ymin = CI_low, ymax = CI_high),
size = .1,
color = "white"
) +
labs(
title = "Model Estimated Warmth/Competence Means for Levels of Salary",
x = "Salary Level",
y = "Warmth/Competence Scale"
) +
guides(
fill = "none",
color = "none"
) +
scale_fill_manual(values = c("purple", "brown", "blue")) +
scale_color_manual(values = c("purple", "brown", "blue")) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
workingjobs.df |>
ggplot(aes(x = sal_ord, y = comp_sim)) +
# Add base data
geom_violin(aes(fill = sal_ord), alpha = .5) +
geom_jitter(aes(color = sal_ord), width = 0.1, height = 0, alpha = 0.25, size = .75) +
# Add pointrange and line for means
geom_line(data = means, aes(y = Mean, group = 1), linewidth = 1) +
geom_pointrange(
data = means,
aes(y = Mean, ymin = CI_low, ymax = CI_high),
size = .5,
color = "white"
) +
labs(
title = "Model Estimated Warmth/Competence Means for Levels of Salary",
x = "Salary Level",
y = "Warmth/Competence Scale"
) +
guides(
fill = "none",
color = "none"
) +
scale_fill_manual(values = c("purple", "brown", "blue")) +
scale_color_manual(values = c("purple", "brown", "blue")) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
workingjobs.df |>
ggplot(aes(x = sal_ord, y = comp_sim)) +
# Add base data
geom_violin(aes(fill = sal_ord), alpha = .5) +
geom_jitter(aes(color = sal_ord), width = 0.1, height = 0, alpha = 0.25, size = .75) +
# Add pointrange and line for means
geom_line(data = means, aes(y = Mean, group = 1), linewidth = 1) +
geom_pointrange(
data = means,
aes(y = Mean, ymin = CI_low, ymax = CI_high),
size = .5,
color = "white"
) +
labs(
title = "Model Estimated Warmth/Competence Means for Levels of Salary",
x = "Salary Level",
y = "Warmth/Competence Scale"
) +
guides(
fill = "none",
color = "none"
) +
scale_fill_manual(values = c("purple", "brown", "blue")) +
scale_color_manual(values = c("purple", "brown", "blue")) +
theme_ft_rc(base_size = 24,
axis_text_size = 24,
axis_title_size = 24,
plot_title_size = 30,
strip_text_size = 24)
estimate_relation(our_multimodel) |>
plot()
